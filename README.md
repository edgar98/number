# Реализация тестового задания "Гаишник"

Сервис позволяет получать регистрационные знаки вида `А000АА 116 RUS`, где
- `А` — буква из множества `[А, Е, Т, О, Р, Н, У, К, Х, С, В, М]`;
- `0` — цифра;
- `116 RUS` — константа.

## API сервиса

Сервер имеет два API метода:

### Метод `/next`

Возвращает текст (`text/plain`) регистрационного знака обозначенного вида.
Значением знака является следующий от последнего выданного, не выдававшийся пользователю ранее знак.
Следующим считается номер, значение числовой части которого больше на 1 (А**000**АА -> А**001**АА), далее,
если число достигло максимального `999`, увеличивается буквенное значение (**А**999**АА** -> **А**000**АВ**).
Порядок букв соответсвует их порядку в алфавите.

Пример:
1. В ответ на GET запрос (`next` или `random`) был возвращен знак со значением **"В115ТМ 116 RUS"**;
2. Ответом на повторный GET запрос `/next` будет знак со значением **"В116ТМ 116 RUS"**.

### Метод `/random`

Возвращает текст (`text/plain`) регистрационного знака обозначенного вида.
Значение знака генерируется случайным образом, значения знаков не повторяются.

## Детали реализации

- Java 17
- Приложение написано с использованием **Spring Boot**
- Для хранения используется БД **PostgreSQL**
- Сборка в `.war`-файл для деплоя в контейнер сервлетов **Apache Tomcat 10**
- Юнит- и интеграционные тесты (**JUnit**, **AssertJ**, **Spring Boot Test**)
- Анализ покрытия **JaCoCo**

Цифро-буквенное значение номера представляется в виде числа:
- цифры воспринимаются в десятичной системе счисления,
- буквы в системе счисления с основанием, равным мощности алфавита (в данном случае 12).
В базе хранятся только выданные номера, полями являются:
- идентификатор (первичный ключ)
- значение номера в десятичной системе счисления.
Случайная генерация с помощью ~~хитрого~~ SQL-запроса в [LicensePlateRepository](src/main/java/com/example/number/repository/LicensePlateRepository.java#L20).
Последний выданный номер определяется посредством первичного ключа сущности [LicensePlate.id](src/main/java/com/example/number/model/LicensePlate.java#L29).

## Сборка

Windows:
```ps
.\mvnw.cmd package
```
Unix:
```sh
./mvnw package
```

## Деплой

- Скопировать `number.war` папку `apache-tomcat-10*/webapps`
- Запустить сервер `Tomcat`

Для запуска сервиса, следует убедиться, что на машине с контейнером сервлетов запущена
СУБД PostgreSQL с базой данных `numbers`, пользователь для входа `app_db`, пароль `app_db`, порт стандартный `5432`.
Если данные входа отличаются — отредактировать файл [application.properties](src/main/resources/application.properties)
